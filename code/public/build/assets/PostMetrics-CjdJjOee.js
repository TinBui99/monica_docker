import{e as S,r as v,h as a,o as r,a as o,i as m,t as i,F as g,j as h,b,u as p,n as y,k as E,p as B}from"./app-CapNgXf-.js";import{E as N}from"./Errors-ClHFmp7Z.js";import{T as x}from"./TextInput-C8RADZPb.js";import{P as T}from"./PrettyButton-C7IwNjfl.js";import{P as F}from"./PrettySpan-CCXc1kgI.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-jKXsEGte.js";const z={class:"mb-8"},A={class:"mb-2 flex items-center justify-between font-bold"},J={class:"mb-1 font-semibold"},K={key:0,class:"mb-2 rounded-xs border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},U={class:"italic"},D={class:"flex items-center"},H={class:"font-mono text-sm"},L=["onClick"],O=["onClick"],G=["onClick"],Q={class:"text-blue-500 hover:underline"},R={class:"text-blue-500 hover:underline"},W={key:1,class:"mb-6 rounded-lg border border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-900"},X=["onSubmit"],Y={class:"border-b border-gray-200 p-2 dark:border-gray-700"},Z={class:"flex justify-between p-2"},M={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},j={__name:"PostMetrics",props:{data:Object},setup(w){const $=w,n=S({journal_metric_id:"",label:"",value:""}),f=v(!1),u=v($.data.journal_metrics),_=v(0),d=v(!1),c=v(0),C=e=>{_.value=e.id,d.value=!0,n.label="",n.value=""},P=e=>{c.value=e.id},V=e=>{f.value="loading",n.journal_metric_id=e.id,axios.post(e.url.store,n).then(s=>{f.value="",u.value[u.value.findIndex(t=>t.id===e.id)].post_metrics.push(s.data.data),d.value=!1}).catch(()=>{f.value=""})},I=(e,s)=>{confirm(B("Are you sure? This action cannot be undone."))&&axios.delete(s.url.destroy).then(()=>{var t=u.value.findIndex(k=>k.id===e.id),l=u.value[t].post_metrics.findIndex(k=>k.id===s.id);u.value[t].post_metrics.splice(l,1)})};return(e,s)=>(r(),a("div",z,[o("p",A,[o("span",null,i(e.$t("Post metrics")),1)]),(r(!0),a(g,null,h(u.value,t=>(r(),a("div",{key:t.id,class:"mb-3"},[o("div",J,i(t.label),1),t.post_metrics.length>0?(r(),a("ul",K,[(r(!0),a(g,null,h(t.post_metrics,l=>(r(),a("li",{key:l.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-1 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 dark:hover:bg-slate-800"},[o("span",U,i(l.label),1),o("div",D,[o("span",H,i(l.value),1),c.value===t.id?(r(),a("span",{key:0,onClick:k=>I(t,l),class:"ms-2"},s[6]||(s[6]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4 cursor-pointer text-red-500 hover:text-red-900"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,L)):m("",!0)])]))),128))])):m("",!0),o("ul",null,[!d.value&&c.value!==t.id?(r(),a("li",{key:0,onClick:l=>C(t),class:"mb-6 me-3 inline cursor-pointer text-sm text-blue-500 hover:underline"},i(e.$t("add a new metric")),9,O)):m("",!0),!d.value&&t.post_metrics.length>0&&c.value!==t.id?(r(),a("li",{key:1,onClick:l=>P(t),class:"mb-6 inline cursor-pointer text-sm"},[o("span",Q,i(e.$t("edit")),1)],8,G)):m("",!0),c.value===t.id?(r(),a("li",{key:2,onClick:s[0]||(s[0]=l=>c.value=0),class:"mb-6 inline cursor-pointer text-sm"},[o("span",R,i(e.$t("close edit mode")),1)])):m("",!0)]),d.value&&t.id===_.value?(r(),a("div",W,[o("form",{onSubmit:E(l=>V(t),["prevent"])},[o("div",Y,[b(N,{errors:p(n).errors},null,8,["errors"]),b(x,{modelValue:p(n).value,"onUpdate:modelValue":s[1]||(s[1]=l=>p(n).value=l),autofocus:!0,class:y("mb-5"),"input-class":"block w-full",required:!0,type:"number",min:0,max:1e6,label:e.$t("Numerical value"),onEscKeyPressed:s[2]||(s[2]=l=>d.value=!1)},null,8,["modelValue","label"]),b(x,{modelValue:p(n).label,"onUpdate:modelValue":s[3]||(s[3]=l=>p(n).label=l),class:y("mb-5"),"input-class":"block w-full",required:!1,maxlength:255,label:e.$t("More details"),onEscKeyPressed:s[4]||(s[4]=l=>d.value=!1)},null,8,["modelValue","label"])]),o("div",Z,[b(F,{text:e.$t("Cancel"),class:y("me-3"),onClick:s[5]||(s[5]=l=>d.value=!1)},null,8,["text"]),b(T,{href:"data.url.vault.create",text:e.$t("Save"),state:f.value,icon:"check",class:y("save")},null,8,["text","state"])])],40,X)])):m("",!0)]))),128)),u.value.length<=0?(r(),a("p",M,i(e.$t("There are no journal metrics.")),1)):m("",!0)]))}},ne=q(j,[["__scopeId","data-v-80ef6af2"]]);export{ne as default};
