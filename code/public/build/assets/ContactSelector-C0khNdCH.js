import{p as $,B as E,r as y,e as F,s as B,v as K,f as L,h as r,o as a,a as s,i,d as p,t as o,F as k,j as f,b as x,x as R,u as n,aM as z,H,n as P,D as C,w as G,l as J}from"./app-CapNgXf-.js";import{E as O}from"./Errors-ClHFmp7Z.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as W}from"./Layout-BAHf2dOa.js";const X={key:0,class:"mb-2 block text-sm"},Y={key:0,class:"optional-badge rounded-xs px-[3px] py-px text-xs"},Z={key:1,class:"mb-4 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},ee={class:"text-sm"},te=["onClick"],re={key:0},ae={class:"relative mb-3"},se=["type","name","required","placeholder"],le={key:0,class:"length absolute rounded-xs text-xs"},oe={key:0,class:"mb-6"},de={class:"mb-2 mt-2 text-center text-sm text-gray-600 dark:text-gray-400"},ne={class:"rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},ie={class:"text-sm"},ue=["onClick"],ce={key:1,class:"mb-6 rounded-lg border border-gray-200 bg-white p-6 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900"},ge={key:2,class:"mb-6 rounded-lg border border-gray-200 bg-white p-6 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900"},he={key:3,class:"mb-3"},be={class:"mb-4 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},ye={class:"text-sm"},me=["onClick"],pe={key:4,class:"mb-3 rounded-lg border border-gray-200 bg-white p-6 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900"},ve={__name:"ContactSelector",props:{modelValue:{type:Array,default:()=>[]},inputClass:String,placeholder:{type:String,default:()=>$("Find a contact in this vault")},label:String,labelCta:{type:String,default:()=>$("+ add a contact")},type:{type:String,default:"text"},required:Boolean,displayMostConsultedContacts:Boolean,addMultipleContacts:Boolean,searchUrl:String,mostConsultedContactsUrl:String},emits:["update:modelValue"],setup(u,{emit:I}){const g=u,w=I,S=E("searchInput"),b=y(!1),m=y(!1),d=y(g.modelValue),T=y([]),h=y([]),l=F({searchTerm:"",errors:[]}),q=B(()=>!g.addMultipleContacts&&d.value.length>=1?!1:!b.value),A=B(()=>["ps-8 w-full rounded-md shadow-xs","bg-white dark:bg-slate-900 border-gray-300 dark:border-gray-700","focus:border-indigo-300 focus:ring-3 focus:ring-indigo-200/50","disabled:bg-slate-50 dark:disabled:bg-slate-900",g.inputClass]);K(()=>{g.displayMostConsultedContacts&&j()}),L(()=>g.modelValue,e=>{d.value=e});const N=()=>{b.value=!0,l.searchTerm="",C().then(()=>S.value.focus())},U=()=>{v.cancel(),b.value=!1},j=()=>{axios.get(g.mostConsultedContactsUrl).then(e=>{T.value=e.data.data})},M=e=>{d.value.findIndex(t=>t.id===e.id)===-1&&(d.value.push(e),l.searchTerm="",b.value=!1,C().then(()=>w("update:modelValue",d.value)))},D=e=>{let c=d.value.findIndex(t=>t.id===e.id);d.value.splice(c,1),C().then(()=>w("update:modelValue",d.value))},v=_.debounce(()=>{l.searchTerm!==""&&l.searchTerm.length>=3?(m.value=!0,axios.post(g.searchUrl,l).then(e=>{h.value=_.filter(e.data.data,c=>_.every(d.value,t=>c.id!==t.id)),m.value=!1}).catch(e=>{l.errors=e.response.data,m.value=!1})):h.value=[]},300);return(e,c)=>(a(),r("div",null,[s("div",null,[u.label?(a(),r("label",X,[p(o(u.label)+" ",1),u.required?i("",!0):(a(),r("span",Y,o(e.$t("optional")),1))])):i("",!0),d.value.length>0?(a(),r("ul",Z,[(a(!0),r(k,null,f(d.value,t=>(a(),r("li",{key:t.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 dark:hover:bg-slate-800"},[x(n(J),{href:t.url},{default:G(()=>[p(o(t.name),1)]),_:2},1032,["href"]),s("ul",ee,[s("li",{class:"inline cursor-pointer text-blue-500 hover:underline",onClick:V=>D(t)},o(e.$t("Remove")),9,te)])]))),128))])):i("",!0),q.value?(a(),r("p",{key:2,class:"inline-block cursor-pointer rounded-lg border bg-slate-200 px-1 py-1 text-xs hover:bg-slate-300 dark:border-gray-700 dark:bg-slate-500 dark:text-gray-900 dark:hover:bg-slate-700",onClick:N},o(u.labelCta),1)):i("",!0)]),b.value?(a(),r("div",re,[s("div",ae,[x(n(W),{class:"absolute start-2 top-2 h-4 w-4 text-gray-400"}),R(s("input",{ref_key:"searchInput",ref:S,"onUpdate:modelValue":c[0]||(c[0]=t=>n(l).searchTerm=t),class:P(A.value),type:u.type,name:e.name,required:u.required,placeholder:u.placeholder,onKeyup:c[1]||(c[1]=(...t)=>n(v)&&n(v)(...t)),onKeydown:H(U,["esc"])},null,42,se),[[z,n(l).searchTerm]]),e.maxlength&&e.displayMaxLength?(a(),r("span",le,o(e.charactersLeft),1)):i("",!0)]),d.value.length===0&&u.displayMostConsultedContacts&&h.value.length===0&&n(l).searchTerm.length===0?(a(),r("div",oe,[s("p",de,o(e.$t("Maybe one of these contacts?")),1),s("ul",ne,[(a(!0),r(k,null,f(T.value,t=>(a(),r("li",{key:t.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 dark:hover:bg-slate-800"},[p(o(t.name)+" ",1),s("ul",ie,[s("li",{class:"inline cursor-pointer text-blue-500 hover:underline",onClick:V=>M(t)},o(e.$t("Add")),9,ue)])]))),128))])])):i("",!0),m.value?(a(),r("div",ce,[s("p",null,o(e.$t("Searchingâ€¦")),1)])):i("",!0),n(l).searchTerm.length<3&&n(l).searchTerm.length!==0?(a(),r("div",ge,[s("p",null,o(e.$t("Please enter at least 3 characters to initiate a search.")),1)])):i("",!0),h.value.length!==0&&n(l).searchTerm.length!==0?(a(),r("div",he,[x(O,{errors:n(l).errors},null,8,["errors"]),s("ul",be,[(a(!0),r(k,null,f(h.value,t=>(a(),r("li",{key:t.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 dark:hover:bg-slate-800"},[p(o(t.name)+" ",1),s("ul",ye,[s("li",{class:"inline cursor-pointer text-blue-500 hover:underline",onClick:V=>M(t)},o(e.$t("Add")),9,me)])]))),128))])])):i("",!0),h.value.length===0&&n(l).searchTerm.length>=3?(a(),r("div",pe,[s("p",null,o(e.$t("No results found")),1)])):i("",!0)])):i("",!0)]))}},_e=Q(ve,[["__scopeId","data-v-5d42731e"]]);export{_e as C};
