import{p,r as $,M as S,B as x,s as B,E as N,h as f,o as w,a as i,b as o,A as E,w as r,d as n,t,n as K,i as v,k as M,H as T,D as y}from"./app-CapNgXf-.js";import{_ as C}from"./Button-CeJKJvkU.js";import{_ as A}from"./DialogModal-DpvCIBlW.js";import{_ as D}from"./Input-DBW5TJZF.js";import{_ as I}from"./InputError-BapgdLlk.js";import{_ as z}from"./SecondaryButton-LDZ02WBB.js";import F from"./WebauthnTest-DWVvjNye.js";const H={key:0,class:"mt-4"},O={key:1,class:"mt-5 border-t border-gray-300 dark:border-gray-700"},R={class:"mx-auto px-4 text-l italic text-gray-600 dark:text-gray-200"},U={class:"mt-4"},X={__name:"ConfirmsPassword",props:{title:{type:String,default:p("Confirm access")},content:{type:String,default:p("For your security, please confirm the access to continue.")},button:{type:String,default:p("Confirm")}},emits:["confirmed"],setup(l,{emit:V}){const g=V,c=$(!1),e=S({password:"",error:"",processing:!1}),d=$(null),h=x("webauthn"),_=B(()=>N().props.hasKey===!0),P=()=>{axios.get(route("password.confirmation")).then(s=>{s.data.confirmed?g("confirmed"):(c.value=!0,y().then(()=>d.value.focus()))})},k=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,b()}).catch(s=>{e.processing=!1,e.error=s.response.data.errors.password[0],y().then(()=>d.value.focus())})},b=()=>{u(),y().then(()=>g("confirmed"))},u=()=>{c.value=!1,e.password="",e.error=""};return(s,a)=>(w(),f("span",null,[i("span",{onClick:P},[E(s.$slots,"default")]),o(A,{show:c.value,onClose:u},{title:r(()=>[n(t(l.title),1)]),content:r(()=>[n(t(l.content)+" ",1),_.value?(w(),f("div",H,[i("p",null,t(s.$t("When you are ready, authenticate using the button below:")),1),o(C,{class:"mt-2 block",onClick:a[0]||(a[0]=M(m=>h.value.start(),["prevent"]))},{default:r(()=>[n(t(s.$t("Confirm your passkey or security key")),1)]),_:1}),o(F,{ref_key:"webauthn",ref:h,onSuccess:a[1]||(a[1]=m=>b())},null,512)])):v("",!0),_.value?(w(),f("fieldset",O,[i("legend",R,t(s.$t("Or")),1)])):v("",!0),i("div",U,[n(t(s.$t("Authenticate using your password:"))+" ",1),o(D,{ref_key:"passwordInput",ref:d,modelValue:e.password,"onUpdate:modelValue":a[2]||(a[2]=m=>e.password=m),type:"password",class:"mt-1 block w-3/4",placeholder:s.$t("Password"),autocomplete:"current-password",onKeyup:T(k,["enter"])},null,8,["modelValue","placeholder"]),o(I,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:r(()=>[o(z,{onClick:u},{default:r(()=>[n(t(s.$t("Cancel")),1)]),_:1}),o(C,{class:K(["ms-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:k},{default:r(()=>[n(t(l.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}};export{X as _};
