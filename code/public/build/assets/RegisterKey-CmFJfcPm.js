import{r as g,B as K,v as S,D as i,f as x,s as I,h as M,o as B,b as t,x as $,a as c,I as y,H as C,w as b,d as _,t as h,n as D,k as N}from"./app-CapNgXf-.js";import{_ as R}from"./Label-WzmNYhjC.js";import{_ as T}from"./Input-DBW5TJZF.js";import{_ as w}from"./InputError-BapgdLlk.js";import{_ as V}from"./SecondaryButton-LDZ02WBB.js";import{_ as j}from"./Button-CeJKJvkU.js";import{_ as q}from"./WaitForKey-BYvq9w9Y.js";import"./createLucideIcon-jKXsEGte.js";const z={class:"mt-4"},E={class:"mt-4"},F={class:"mt-5 flex items-center"},Q={__name:"RegisterKey",props:{errorMessage:String,name:String,form:Object},emits:["start","stop","register","update:name"],setup(a,{emit:k}){const o=a,l=k,r=g(!1),n=g(o.errorMessage),d=K("nameInput");S(()=>{o.form.reset(),i().then(()=>d.value.focus())}),x(()=>o.errorMessage,e=>{n.value=e});const u=I(()=>r.value===!0||o.form.processing),f=()=>{r.value=!0,n.value="",i().then(()=>l("start")),axios.post(route("webauthn.store.options")).then(e=>{e.data!==void 0?p(e.data.publicKey):i().then(()=>p(e.props.publicKey))}).catch(e=>{v(),n.value=e.response.data.errors[0]})},p=e=>{r.value===!0&&l("register",e)},v=()=>{r.value=!1,i().then(()=>l("stop"))};return(e,s)=>(B(),M("form",{onSubmit:N(f,["prevent"])},[t(w,{message:a.form.errors.register,class:"mt-2"},null,8,["message"]),$(c("div",z,[t(R,{for:"name",value:e.$t("Key name")},null,8,["value"]),t(T,{type:"text",class:"mt-1 block w-3/4",id:"name",ref_key:"nameInput",ref:d,value:a.name,onInput:s[0]||(s[0]=m=>e.$emit("update:name",m.target.value)),required:"",onKeyup:s[1]||(s[1]=C(m=>f(),["enter"]))},null,8,["value"]),t(w,{message:a.form.errors.name,class:"mt-2"},null,8,["message"])],512),[[y,!u.value||a.form.errors.name]]),$(c("div",E,[t(q,{"error-message":n.value,form:a.form,onRetry:s[2]||(s[2]=m=>f())},null,8,["error-message","form"])],512),[[y,r.value]]),c("div",F,[t(V,{onClick:s[3]||(s[3]=m=>v())},{default:b(()=>[_(h(e.$t("Cancel")),1)]),_:1}),t(j,{class:D(["ms-2",{"opacity-25":u.value}]),disabled:u.value},{default:b(()=>[_(h(e.$t("Submit")),1)]),_:1},8,["class","disabled"])])],32))}};export{Q as default};
